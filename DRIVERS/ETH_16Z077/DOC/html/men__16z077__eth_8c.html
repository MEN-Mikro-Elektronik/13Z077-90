<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>MEN - Linux native Driver for 16Z077/87 Ethernet IP cores - men_16z077_eth.c File Reference</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<meta name="Language" content="en, english">
<meta name="Copyright" content="All material copyright MEN Mikro Elektronik GmbH">
<link href="men_stylesheet.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class="left_to_right" style="padding-top: 6px; background-color: #F0F0F0; height: 110px; border-bottom: 2px solid #D1D1D2;">
	<!-- Titel -->
	<img src="menlogo.gif" alt="MEN" style="float: left; height: 103px; width: 155px; margin: 0px;">
	<h1 style="margin: 0px; padding-top: 35px; padding-bottom: 0px;">Linux native Driver for 16Z077/87 Ethernet IP cores &nbsp; </h1>
	<h3>men_16z077_eth.c File Reference</h3>
</div>

<div class="left_to_right">
<!-- Hauptteil -->
	<div class="main">
<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>men_16z077_eth.c File Reference</h1>driver for IP core 16Z087 (Ethernet cores).  
<a href="#_details">More...</a>
<p>
<table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="structz77__private.html">z77_private</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">z077_private: main data struct for the driver <br>
 this struct keeps all data for a per-IP-core instance of 16Z077/87 </em> <a href="structz77__private.html#_details">More...</a><em><br><br></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a48">z77_open</a> (struct net_device *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">z77_open - open the ethernet device for first usage Open/initialize the Ethernet device. This routine should set everything up anew at each open, even registers that should only need to be set once at boot, so that there is non-reboot way to recover if something goes wrong. </em> <a href="#a48"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a49">z77_send_packet</a> (struct sk_buff *skb, struct net_device *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send a ready made ethernet frame </em> <a href="#a49"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>irqreturn_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a50">z77_irq</a> (int irq, void *dev_id)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">central IRQ handler </em> <a href="#a50"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a51">z77_close</a> (struct net_device *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The inverse routine to <a class="el" href="men__16z077__eth_8c.html#a48">z77_open()</a>. </em> <a href="#a51"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>net_device_stats *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a52">z77_get_stats</a> (struct net_device *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the current statistics. </em> <a href="#a52"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a53">z77_tx_timeout</a> (struct net_device *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Timeout handler when no scheduled ETH irq arrived. </em> <a href="#a53"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a54">z77_rx_err</a> (struct net_device *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">net_rx_err - irq context handler to report Errors </em> <a href="#a54"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a55">z77_tx_err</a> (struct net_device *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">net_tx_err - irq context handler to report Errors </em> <a href="#a55"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a56">z77_poll</a> (struct napi_struct *napi, int budget)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">z77_poll - Rx poll function to support the NAPI functionality </em> <a href="#a56"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a58">z77_phy_reset</a> (struct net_device *dev, u8 phyAddr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">z77_phy_reset This routine send a Reset command to the PHY specified in the parameter phyaddr. </em> <a href="#a58"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a59">z77_phy_identify</a> (struct net_device *dev, u8 phyAddr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">z77_phy_identify - probe the PHY device This routine probes the PHY device by reading its PHY Identifier Register </em> <a href="#a59"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a60">z77_phy_init</a> (struct net_device *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">z77_phy_init - initialize and configure the PHY devices This routine scans, initializes and configures PHY devices. </em> <a href="#a60"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a61">z77_init_phymode</a> (struct net_device *dev, u8 phyAddr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">z77_init_phymode - Set Phy Mode and Flags according to given mode </em> <a href="#a61"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a62">z77_pass_packet</a> (struct net_device *dev, unsigned int idx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">z77_pass_packet - packet passing function for one ETH frame </em> <a href="#a62"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a65">z77_reset</a> (struct net_device *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">z77_reset - reset device with asynchronous global Reset Register 0x54 </em> <a href="#a65"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a66">z77_ioctl</a> (struct net_device *dev, struct ifreq *ifr, int cmd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ioctl function - interface to applications </em> <a href="#a66"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a76">z77_store_mac</a> (struct net_device *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write MAC address from struct net to Registers MAC_ADDR0/1. </em> <a href="#a76"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a77">z77_set_rx_mode</a> (struct net_device *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle multicast and promiscuous mode set. </em> <a href="#a77"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a95">z77_bd_setup</a> (struct net_device *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">z77_bd_setup - perform initialization of buffer descriptors this initializes the buffer descriptors such that PCI DMA - ready memory chunks are allocated </em> <a href="#a95"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a96">z77_do_autonegotiation</a> (struct net_device *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Do the complete Autonegotiation for the used Ethernet PHY. </em> <a href="#a96"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a97">cleanup_card</a> (struct net_device *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">remove the NIC from Kernel </em> <a href="#a97"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a98">z77_reset_task</a> (struct work_struct *work)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Timeout handler when no scheduled ETH irq arrived. </em> <a href="#a98"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>u32&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a99">z77_get_oldest_frame</a> (u32 rx0, u32 rx1, u32 *nrframes)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">When RX0 or RX1 nonempty, return oldest entry. </em> <a href="#a99"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>unsigned int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a100">smb_cycle</a> (struct net_device *dev, unsigned char c)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">perform a SMBus cycle on EEprom </em> <a href="#a100"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>unsigned char&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a101">z77_read_byte_data</a> (struct net_device *dev, unsigned int offset)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read a byte from MAC EEPROM directly attached to this Z87 Every cycle of the SMB access is coded in a descriptive string: S: Start 0: 0 O: Stop 1: 1 R: Read A: Ack (SDA just set high, no check!) W: Write P: Pause 50 us G: Get bit (=reads SDA) Attention: this assumes that exactly one byte is read (8x'G' in a row)! </em> <a href="#a101"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a102">z77_get_mac_from_board_id</a> (u8 *mac)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">finding a board ident EEPROM to read MAC from </em> <a href="#a102"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a103">chipset_init</a> (struct net_device *dev, u32 first_init)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize the IP core Registers setup the necessary Registers like MODER, BDNUM (used on Z77 only) ans others such that the NIC can completely be restarted if needed. </em> <a href="#a103"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a104">z77_tx</a> (struct net_device *dev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The interrupt context Tx packet handler Called from within main ISR context. unmaps allocated PCI transfer memory region and updates stats info. No spin_lock here because main irq routine does local Eth core IRQ disabling already. </em> <a href="#a104"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a105">men_16z077_probe</a> (CHAMELEON_UNIT_T *chu)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">men_16z077_probe - PNP function for ETH, per instance </em> <a href="#a105"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a106">men_16z077_remove</a> (CHAMELEON_UNIT_T *chu)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">PNP function to remove the unit driver. </em> <a href="#a106"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a name="a107" doxytag="men_16z077_eth.c::men_16z077_cleanup"></a>
void __exit&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a107">men_16z077_cleanup</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">drivers cleanup routine <br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int __init&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a108">men_16z077_init</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">module init function </em> <a href="#a108"></a><em><br><br></td></tr>
<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a name="a40" doxytag="men_16z077_eth.c::z77_ethtool_ops"></a>
ethtool_ops&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="men__16z077__eth_8c.html#a40">z77_ethtool_ops</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This structure provides the interface functions to the standard ethtool. <br><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
driver for IP core 16Z087 (Ethernet cores). 
<p>
<dl compact><dt><b>Author:</b></dt><dd><a href="mailto:thomas.schnuerer@men.de">thomas.schnuerer@men.de</a></dd></dl>
<p>
Switches:<p>
--------------------------------------------------------------------------- Copyright (c) 2019, MEN Mikro Elektronik GmbH<hr><h2>Function Documentation</h2>
<a name="a103" doxytag="men_16z077_eth.c::chipset_init"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int chipset_init </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname" nowrap> <em>dev</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>first_init</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialize the IP core Registers setup the necessary Registers like MODER, BDNUM (used on Z77 only) ans others such that the NIC can completely be restarted if needed. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC </td></tr>
    <tr><td valign=top><em>first_init</em>&nbsp;</td><td><b>IN</b> nonzero if Autoneg. shall be performed</td></tr>
  </table>
</dl>
<p>
<dl compact><dt><b>Returns:</b></dt><dd>0 or error code </dd></dl>
    </td>
  </tr>
</table>
<a name="a97" doxytag="men_16z077_eth.c::cleanup_card"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void cleanup_card </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dev</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
remove the NIC from Kernel 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 or error code </dd></dl>
    </td>
  </tr>
</table>
<a name="a108" doxytag="men_16z077_eth.c::men_16z077_init"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int __init men_16z077_init </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
module init function 
<p>
We are a chameleon unit driver rather than a true standalone Ethernet driver, so all Z77 detection, negotiation and stuff is done at its probe() routine<p>
<dl compact><dt><b>Returns:</b></dt><dd>0 or error code from men_chameleon_register_driver </dd></dl>
    </td>
  </tr>
</table>
<a name="a105" doxytag="men_16z077_eth.c::men_16z077_probe"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int men_16z077_probe </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">CHAMELEON_UNIT_T *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chu</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
men_16z077_probe - PNP function for ETH, per instance 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>chu</em>&nbsp;</td><td><b>IN</b> wdt unit found </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 on success or negative linux error number </dd></dl>
    </td>
  </tr>
</table>
<a name="a106" doxytag="men_16z077_eth.c::men_16z077_remove"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int men_16z077_remove </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">CHAMELEON_UNIT_T *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chu</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
PNP function to remove the unit driver. 
<p>
The netdev struct is kept in struct CHAMELEON_UNIT_Ts private driver data pointer so any number of found netdevs can be freed.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>chu</em>&nbsp;</td><td><b>IN</b> IP core unit to remove</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 on success or negative linux error number </dd></dl>
    </td>
  </tr>
</table>
<a name="a100" doxytag="men_16z077_eth.c::smb_cycle"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> unsigned int smb_cycle </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname" nowrap> <em>dev</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>unsigned char&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
perform a SMBus cycle on EEprom 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC </td></tr>
    <tr><td valign=top><em>c</em>&nbsp;</td><td><b>IN</b> command char to describe which cycle to perform</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 or 1 when cycle='G' or 0xffff </dd></dl>
    </td>
  </tr>
</table>
<a name="a95" doxytag="men_16z077_eth.c::z77_bd_setup"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int z77_bd_setup </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dev</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
z77_bd_setup - perform initialization of buffer descriptors this initializes the buffer descriptors such that PCI DMA - ready memory chunks are allocated 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC</td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="a51" doxytag="men_16z077_eth.c::z77_close"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int z77_close </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dev</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The inverse routine to <a class="el" href="men__16z077__eth_8c.html#a48">z77_open()</a>. 
<p>
The network interfaces resources are deallocated here<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>error code or 0 on success </dd></dl>
    </td>
  </tr>
</table>
<a name="a96" doxytag="men_16z077_eth.c::z77_do_autonegotiation"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int z77_do_autonegotiation </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dev</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Do the complete Autonegotiation for the used Ethernet PHY. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 or error code </dd></dl>
    </td>
  </tr>
</table>
<a name="a102" doxytag="men_16z077_eth.c::z77_get_mac_from_board_id"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int z77_get_mac_from_board_id </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">u8 *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>mac</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
finding a board ident EEPROM to read MAC from 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>mac</em>&nbsp;</td><td><b>IN</b> pointer to 6 byte for retrieved MAC storage</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>1 if MAC retrieved or 0 if none found </dd></dl>
    </td>
  </tr>
</table>
<a name="a99" doxytag="men_16z077_eth.c::z77_get_oldest_frame"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> u32 z77_get_oldest_frame </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">u32&nbsp;</td>
          <td class="mdname" nowrap> <em>rx0</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>u32&nbsp;</td>
          <td class="mdname" nowrap> <em>rx1</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>u32 *&nbsp;</td>
          <td class="mdname" nowrap> <em>nrframes</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
When RX0 or RX1 nonempty, return oldest entry. 
<p>
This is tailored for the 2 32bit Registers RX0_EMPTY, RX1_EMPTY.<p>
<dl compact><dt><b>Returns:</b></dt><dd>oldest (rightmost) bit in Rx0/1_EMPTY </dd></dl>
    </td>
  </tr>
</table>
<a name="a52" doxytag="men_16z077_eth.c::z77_get_stats"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> struct net_device_stats * z77_get_stats </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dev</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get the current statistics. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>pointer to device status struct </dd></dl>
    </td>
  </tr>
</table>
<a name="a61" doxytag="men_16z077_eth.c::z77_init_phymode"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int z77_init_phymode </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname" nowrap> <em>dev</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>u8&nbsp;</td>
          <td class="mdname" nowrap> <em>phyAddr</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
z77_init_phymode - Set Phy Mode and Flags according to given mode 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC </td></tr>
    <tr><td valign=top><em>phyAddr</em>&nbsp;</td><td><b>IN</b> PHY Chip address, one of 0 to 31. Is 1 at EM01</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 or error code </dd></dl>
    </td>
  </tr>
</table>
<a name="a66" doxytag="men_16z077_eth.c::z77_ioctl"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int z77_ioctl </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname" nowrap> <em>dev</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct ifreq *&nbsp;</td>
          <td class="mdname" nowrap> <em>ifr</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
ioctl function - interface to applications 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC </td></tr>
    <tr><td valign=top><em>ifr</em>&nbsp;</td><td><b>IN</b> interface request struct </td></tr>
    <tr><td valign=top><em>cmd</em>&nbsp;</td><td><b>IN</b> command</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 on success or negative linux error number </dd></dl>
    </td>
  </tr>
</table>
<a name="a50" doxytag="men_16z077_eth.c::z77_irq"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> irqreturn_t z77_irq </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>irq</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>dev_id</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
central IRQ handler 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>irq</em>&nbsp;</td><td><b>IN</b> INTB interrupt </td></tr>
    <tr><td valign=top><em>dev_id</em>&nbsp;</td><td><b>IN</b> unique identifier</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>if IRQ was handled or not </dd></dl>
    </td>
  </tr>
</table>
<a name="a48" doxytag="men_16z077_eth.c::z77_open"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int z77_open </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dev</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
z77_open - open the ethernet device for first usage Open/initialize the Ethernet device. This routine should set everything up anew at each open, even registers that should only need to be set once at boot, so that there is non-reboot way to recover if something goes wrong. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 or error code</dd></dl>
    </td>
  </tr>
</table>
<a name="a62" doxytag="men_16z077_eth.c::z77_pass_packet"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void z77_pass_packet </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname" nowrap> <em>dev</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>idx</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
z77_pass_packet - packet passing function for one ETH frame 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC </td></tr>
    <tr><td valign=top><em>idx</em>&nbsp;</td><td><b>IN</b> Rx BD index, 0..Z077_RBD_NUM</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>- </dd></dl>
    </td>
  </tr>
</table>
<a name="a59" doxytag="men_16z077_eth.c::z77_phy_identify"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int z77_phy_identify </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname" nowrap> <em>dev</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>u8&nbsp;</td>
          <td class="mdname" nowrap> <em>phyAddr</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
z77_phy_identify - probe the PHY device This routine probes the PHY device by reading its PHY Identifier Register 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC </td></tr>
    <tr><td valign=top><em>phyAddr</em>&nbsp;</td><td><b>IN</b> Address of used PHY, currently 1</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>zero if Phy found, otherwise nonzero </dd></dl>
    </td>
  </tr>
</table>
<a name="a60" doxytag="men_16z077_eth.c::z77_phy_init"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int z77_phy_init </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dev</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
z77_phy_init - initialize and configure the PHY devices This routine scans, initializes and configures PHY devices. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC</td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="a58" doxytag="men_16z077_eth.c::z77_phy_reset"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int z77_phy_reset </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname" nowrap> <em>dev</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>u8&nbsp;</td>
          <td class="mdname" nowrap> <em>phyAddr</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
z77_phy_reset This routine send a Reset command to the PHY specified in the parameter phyaddr. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC </td></tr>
    <tr><td valign=top><em>phyAddr</em>&nbsp;</td><td><b>IN</b> Address of used PHY, currently 1</td></tr>
  </table>
</dl>
<p>
<dl compact><dt><b>Returns:</b></dt><dd>0 always </dd></dl>
    </td>
  </tr>
</table>
<a name="a56" doxytag="men_16z077_eth.c::z77_poll"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int z77_poll </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct napi_struct *&nbsp;</td>
          <td class="mdname" nowrap> <em>napi</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>budget</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
z77_poll - Rx poll function to support the NAPI functionality 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>napi</em>&nbsp;</td><td><b>IN</b> NAPI struct for this NIC </td></tr>
    <tr><td valign=top><em>budget</em>&nbsp;</td><td><b>IN</b> allowed # of packets to process in a call</td></tr>
  </table>
</dl>
this is a softirq so dont use potentially sleeping sys calls!<p>
<dl compact><dt><b>Returns:</b></dt><dd>0 if all packets were processed or 1 of not all was processed </dd></dl>
    </td>
  </tr>
</table>
<a name="a101" doxytag="men_16z077_eth.c::z77_read_byte_data"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> unsigned char z77_read_byte_data </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname" nowrap> <em>dev</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>offset</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read a byte from MAC EEPROM directly attached to this Z87 Every cycle of the SMB access is coded in a descriptive string: S: Start 0: 0 O: Stop 1: 1 R: Read A: Ack (SDA just set high, no check!) W: Write P: Pause 50 us G: Get bit (=reads SDA) Attention: this assumes that exactly one byte is read (8x'G' in a row)! 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC </td></tr>
    <tr><td valign=top><em>offset</em>&nbsp;</td><td><b>IN</b> position of byte to read</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>byte value at this offset in EEPROM </dd></dl>
    </td>
  </tr>
</table>
<a name="a65" doxytag="men_16z077_eth.c::z77_reset"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void z77_reset </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dev</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
z77_reset - reset device with asynchronous global Reset Register 0x54 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="a98" doxytag="men_16z077_eth.c::z77_reset_task"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void z77_reset_task </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct work_struct *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>work</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Timeout handler when no scheduled ETH irq arrived. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>work</em>&nbsp;</td><td><b>IN</b> handle of work_struct</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>- </dd></dl>
    </td>
  </tr>
</table>
<a name="a54" doxytag="men_16z077_eth.c::z77_rx_err"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void z77_rx_err </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dev</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
net_rx_err - irq context handler to report Errors 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="a49" doxytag="men_16z077_eth.c::z77_send_packet"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int z77_send_packet </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct sk_buff *&nbsp;</td>
          <td class="mdname" nowrap> <em>skb</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>struct net_device *&nbsp;</td>
          <td class="mdname" nowrap> <em>dev</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send a ready made ethernet frame 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC </td></tr>
    <tr><td valign=top><em>skb</em>&nbsp;</td><td><b>IN</b> struct skbuf with data to transmit</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 or error code </dd></dl>
    </td>
  </tr>
</table>
<a name="a77" doxytag="men_16z077_eth.c::z77_set_rx_mode"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void z77_set_rx_mode </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dev</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle multicast and promiscuous mode set. 
<p>
The set_multi entry point is called whenever the multicast address list or the network interface flags are updated. This routine is responsible for configuring the hardware for proper multicast, promiscuous mode, and all-multi behavior.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="a76" doxytag="men_16z077_eth.c::z77_store_mac"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void z77_store_mac </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dev</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write MAC address from struct net to Registers MAC_ADDR0/1. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="a104" doxytag="men_16z077_eth.c::z77_tx"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void z77_tx </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dev</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The interrupt context Tx packet handler Called from within main ISR context. unmaps allocated PCI transfer memory region and updates stats info. No spin_lock here because main irq routine does local Eth core IRQ disabling already. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>- </dd></dl>
    </td>
  </tr>
</table>
<a name="a55" doxytag="men_16z077_eth.c::z77_tx_err"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void z77_tx_err </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dev</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
net_tx_err - irq context handler to report Errors 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="a53" doxytag="men_16z077_eth.c::z77_tx_timeout"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void z77_tx_timeout </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct net_device *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dev</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Timeout handler when no scheduled ETH irq arrived. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dev</em>&nbsp;</td><td><b>IN</b> net_device struct for this NIC</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>- </dd></dl>
    </td>
  </tr>
</table>

	</div>
</div>

<div class="footer">
<!-- Footer -->
	<p class="footer">
	Generated for Linux native Driver for 16Z077/87 Ethernet IP cores using <a href="http://www.doxygen.org">doxygen</a>.<br>
	Copyright &copy; 2019 <a href="http://www.men.de">MEN Mikro Elektronik GmbH</a>. All Rights Reserved.
	</p>
</div>

</body>
</html>

